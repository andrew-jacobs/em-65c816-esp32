    1                   *       VTL-2
    2                   *       V-3.6
    3                   *       9-23-76
    4                   *       BY GARY SHANNON
    5                   *       & FRANK MCCOY
    6                   *       COPYWRIGHT 1976, THE COMPUTER STORE
    7                   *
    8                   *       DEFINE LOCATIONS IN MONITOR
    9 FF00              INCH       EQU      $FF00
   10 FF24              POLCAT     EQU      $FF24
   11 FF81              OUTCH      EQU      $FF81
   12 FF82              OUTS       EQU      $FF82
   13                   *
   14                   *       FOR SBC6800
   15 001B              BREAK      EQU      $1B         BREAK KEY
   16                   *
   17                   *       SET ASIDE FOUR BYTES FOR USER
   18                   *       DEFINED INTERUPT ROUTINE IF NEEDED
   19 0000                         ORG      $0000
   20 0000              ZERO       RMB      4           INTERUPT VECTOR
   21 0004              AT         RMB      2           CANCEL & C-R
   22                   *
   23                   *       GENERAL PURPOSE STORRGE
   24 0006              VARS       RMB      52          VARIRBLES(A-Z)
   25 003A              BRAK       RMB      2           [
   26 003C              SAVE10     RMB      2           BACK SLASH
   27 003E              BRIK       RMB      2           ]
   28 0040              UP         RMB      2           ^
   29 0042              SAVE11     RMB      2
   30                   *
   31 0044              SAVE14     RMB      2           SPACE
   32 0046              EXCL       RMB      2           !
   33 0048              QUOTE      RMB      2           "
   34 004A              DOLR       RMB      2           #
   35 004C              DOLLAR     RMB      2           $
   36 004E              REMN       RMB      2           %
   37 0050              AMPR       RMB      2           &
   38 0052              QUITE      RMB      2           '
   39 0054              PAREN      RMB      2           (
   40 0056              PARIN      RMB      2           )
   41 0058              STAR       RMB      2           *
   42 005A              PLUS       RMB      2           +
   43 005C              COMA       RMB      2           ,
   44 005E              MINS       RMB      2           -
   45 0060              PERD       RMB      2           .
   46 0062              SLASH      RMB      2           /
   47                   *
   48 0064              SAVE0      RMB      2
   49 0066              SAVE1      RMB      2
   50 0068              SAVE2      RMB      2
   51 006A              SAVE3      RMB      2
   52 006C              SAVE4      RMB      2
   53 006E              SAVE5      RMB      2
   54 0070              SAVE6      RMB      2
   55 0072              SAVE7      RMB      2
   56 0074              SAVE8      RMB      2
   57 0076              SAVE9      RMB      2
   58 0078              COLN       RMB      2           :
   59 007A              SEMI       RMB      2           ;
   60 007C              LESS       RMB      2           <
   61 007E              EQAL       RMB      2           =
   62 0080              GRRT       RMB      1           >
   63 0081              DECB_1     RMB      1
   64                   *
   65 0082              DECBUF     RMB      4
   66 0086              LASTD      RMB      1
   67 0087              DELIM      RMB      1
   68 0088              LINBUF     RMB      73          LINE LENGTH +1
   69                   *
   70 00F1                         ORG      $00F1
   71 00F1              STACK      RMB      1
   72                   *
   73 0100                         ORG      $0100
   74 0100              MI         RMB      4           INTERUPT VECTORS
   75 0104              NMI        RMB      4
   76 0108              PRGM       EQU      *           PROGRAM STARTS HERE
   77                   *
   78 FC00                         ORG      $FC00
   79                   *
   80 FC00 8E00F1       START      LDS      #STACK
   81 FC03 4F                      CLRA
   82 FC04 CEFEFB                  LDX      #OKM
   83 FC07 8D42                    BSR      STRGT
   84                   *
   85 FC09 4F           LOOP       CLRA
   86 FC0A 974A                    STAA     DOLR
   87 FC0C 974B                    STAA     DOLR+1
   88 FC0E BDFEA3                  JSR      CVTLN
   89 FC11 243B                    BCC      STMNT       NO LINE# THEN EXEC
   90 FC13 8D24                    BSR      EXEC
   91 FC15 27E9                    BEQ      START
   92                   *
   93 FC17 8D65         LOOP2      BSR      FIND        FIND LINE
   94 FC19 27E5         EQSTRT     BEQ      START       IF END THEN STOP
   95 FC1B EE00                    LDX      0,X         LOAD REAL LINE #
   96 FC1D DF4A                    STX      DOLR        SAVE IT
   97 FC1F DE42                    LDX      SAVE11      GET LINE
   98 FC21 08                      INX                  BUMP PAST LINE #
   99 FC22 08                      INX                  BUMP PAST LINE #
  100 FC23 08                      INX                  BUMP PAST SPACE
  101 FC24 8D13                    BSR      EXEC        EXECUTE IT
  102 FC26 270D                    BEQ      LOOP3       IF ZERO, CONTINUE
  103 FC28 DE42                    LDX      SAVE11      FIND LINE
  104 FC2A EE00                    LDX      0,X         GET IT
  105 FC2C 9C4A                    CPX      DOLR        HAS IT CHANGED?
  106 FC2E 2705                    BEQ      LOOP3       IF NOT GET NEXT
  107                   *
  108 FC30 08                      INX                  INCREMENT OLD LINE#
  109 FC31 DF46                    STX      EXCL        SAVE FOR RETURN
  110 FC33 20E2                    BRA      LOOP2       CONTINUE
  111                   *
  112 FC35 8D5A         LOOP3      BSR      FND3        FIND NEXT LINE
  113 FC37 20E0                    BRA      EQSTRT      CONTINUE
  114                   *
  115 FC39 DF72         EXEC       STX      SAVE7       EXECUTE LINE
  116 FC3B BDFDEC                  JSR      VAR2
  117 FC3E 08                      INX
  118                   *
  119 FC3F A600         SKIP       LDAA     0,X         GET FIRST TERM
  120 FC41 8D03                    BSR      EVIL        EVALUATE EXPRESSION
  121 FC43 DE4A         OUTX       LDX      DOLR        GET LINE #
  122 FC45 39                      RTS
  123                   *
  124 FC46 8122         EVIL       CMPA     #$22        IF " THEN BRANCH
  125 FC48 264E                    BNE      EVALU
  126 FC4A 08                      INX
  127 FC4B 7EFD75       STRGT      JMP      STRING      TO PRINT IT
  128                   *
  129 FC4E DF74         STMNT      STX      SAVE8       SAVE LINE #
  130 FC50 974A                    STAA     DOLR
  131 FC52 D74B                    STAB     DOLR+1
  132 FC54 DE4A                    LDX      DOLR
  133 FC56 2669                    BNE      SKP2        IF LINE# <> 0
  134                   *
  135 FC58 CE0108                  LDX      #PRGM       LIST PROGRAM
  136 FC5B 9C50         LST2       CPX      AMPR        END OF PROGRAM
  137 FC5D 27BA                    BEQ      EQSTRT
  138 FC5F DF42                    STX      SAVE11      LINE # FOR CVDEC
  139 FC61 A600                    LDAA     0,X
  140 FC63 E601                    LDAB     1,X
  141 FC65 BDFD20                  JSR      PRNT2
  142 FC68 DE42                    LDX      SAVE11
  143 FC6A 08                      INX
  144 FC6B 08                      INX
  145 FC6C BDFD58                  JSR      PNTMSG
  146 FC6F BDFEF2                  JSR      CRLF
  147 FC72 20E7                    BRA      LST2
  148                   *
  149 FC74 DE42         NXTXT      LDX      SAVE11      GET POINTER
  150 FC76 08                      INX                  BUMP PAST LINE#
  151 FC77 08           LOOKAG     INX                  FIND END OF LINE
  152 FC78 6D00                    TST      0,X
  153 FC7A 26FB                    BNE      LOOKAG
  154 FC7C 08                      INX
  155 FC7D 39                      RTS
  156                   *
  157 FC7E CE0108       FIND       LDX      #PRGM       FIND LINE
  158 FC81 DF42         FND2       STX      SAVE11
  159 FC83 9C50                    CPX      AMPR
  160 FC85 2710                    BEQ      RTS1
  161 FC87 A601                    LDAA     1,X
  162 FC89 904B                    SUBA     DOLR+1
  163 FC8B A600                    LDAA     0,X
  164 FC8D 924A                    SBCA     DOLR
  165 FC8F 2404                    BCC      SET
  166 FC91 8DE1         FND3       BSR      NXTXT
  167 FC93 20EC                    BRA      FND2
  168                   *
  169 FC95 86FF         SET        LDAA     #$FF        SET NOT EQUAL
  170 FC97 39           RTS1       RTS
  171                   *
  172 FC98 BDFD80       EVALU      JSR      EVAL        EVALUATE LINE
  173 FC9B 37                      PSHB
  174 FC9C 36                      PSHA
  175 FC9D DE72                    LDX      SAVE7
  176 FC9F BDFDFF                  JSR      CONVP
  177 FCA2 32                      PULA
  178 FCA3 C124                    CMPB     #'$         STRING?
  179 FCA5 2604                    BNE      AR1
  180 FCA7 33                      PULB
  181 FCA8 7EFF81                  JMP      OUTCH       THEN PRINT IT
  182 FCAB C03F         AR1        SUBB     #'?         PRINT?
  183 FCAD 2770                    BEQ      PRNT        THEN DO IT
  184 FCAF 5C                      INCB                 MACHINE LANGUAGE?
  185 FCB0 33                      PULB
  186 FCB1 2601                    BNE      AR2
  187 FCB3 3F                      SWI                  THEN INTERUPT
  188                   *
  189 FCB4 A700         AR2        STAA     0,X         STORE NEW VALUE
  190 FCB6 E701                    STAB     1,X
  191 FCB8 DB52                    ADDB     QUITE       RANDOMIZER
  192 FCBA 9953                    ADCA     QUITE+1
  193 FCBC 9752                    STAA     QUITE
  194 FCBE D753                    STAB     QUITE+1
  195 FCC0 39                      RTS
  196                   *
  197 FCC1 8DBB         SKP2       BSR      FIND        FIND LINE
  198 FCC3 2718                    BEQ      INSRT       IF NOT THERE
  199 FCC5 EE00                    LDX      0,X         THEN INSERT
  200 FCC7 9C4A                    CPX      DOLR        NEW LINE
  201 FCC9 2612                    BNE      INSRT
  202                   *
  203 FCCB 8DA7                    BSR      NXTXT       SETUP REGISTERS
  204 FCCD 9E42                    LDS      SAVE11      FOR DELETE
  205                   *
  206 FCCF 9C50         DELT       CPX      AMPR        DELETE OLD LINE
  207 FCD1 2708                    BEQ      FITIT
  208 FCD3 A600                    LDAA     0,X
  209 FCD5 36                      PSHA
  210 FCD6 08                      INX
  211 FCD7 31                      INS
  212 FCD8 31                      INS
  213 FCD9 20F4                    BRA      DELT
  214                   *
  215 FCDB 9F50         FITIT      STS      AMPR        STORE NEW END
  216                   *
  217 FCDD DE74         INSRT      LDX      SAVE8       COUNT NEW LINE LENGTH
  218 FCDF C603                    LDAB     #$03
  219 FCE1 6D00                    TST      0,X
  220 FCE3 2731                    BEQ      GOTIT       IF NO LINE THEN STOP
  221 FCE5 5C           CNTLN      INCB
  222 FCE6 08                      INX
  223 FCE7 6D00                    TST      0,X
  224 FCE9 26FA                    BNE      CNTLN
  225                   *
  226 FCEB 4F           OPEN       CLRA                 CALCULATE NEW END
  227 FCEC DB51                    ADDB     AMPR+1
  228 FCEE 9950                    ADCA     AMPR
  229 FCF0 973C                    STAA     SAVE10
  230 FCF2 D73D                    STAB     SAVE10+1
  231 FCF4 D059                    SUBB     STAR+1
  232 FCF6 9258                    SBCA     STAR
  233 FCF8 2422                    BCC      RSTRT       IF TOO BIG THEN STOP
  234 FCFA DE50                    LDX      AMPR
  235 FCFC 9E3C                    LDS      SAVE10
  236 FCFE 9F50                    STS      AMPR
  237                   *
  238 FD00 08                      INX                  SLIDE OPEN GAP
  239 FD01 09           SLIDE      DEX
  240 FD02 E600                    LDAB     0,X
  241 FD04 37                      PSHB
  242 FD05 9C42                    CPX      SAVE11
  243 FD07 26F8                    BNE      SLIDE
  244                   *
  245 FD09 9E4A         DON        LDS      DOLR        STORE LINE #
  246 FD0B AF00                    STS      0,X
  247 FD0D 9E74                    LDS      SAVE8       GET NEW LINE
  248 FD0F 34                      DES
  249                   *
  250 FD10 08           MOVL       INX                  INSERT NEW LINE
  251 FD11 33                      PULB
  252 FD12 E701                    STAB     1,X
  253 FD14 26FA                    BNE      MOVL
  254                   *
  255 FD16 8E00F1       GOTIT      LDS      #STACK
  256 FD19 7EFC09                  JMP      LOOP
  257                   *
  258 FD1C 7EFC00       RSTRT      JMP      START
  259                   *
  260 FD1F 33           PRNT       PULB                 PRINT DECIMAL
  261 FD20 CE0082       PRNT2      LDX      #DECBUF     CONVERT TO DECIMAL
  262 FD23 DF6C                    STX      SAVE4
  263 FD25 CEFE5B                  LDX      #PWRS10
  264 FD28 DF6E         CVD1       STX      SAVE5
  265 FD2A EE00                    LDX      0,X
  266 FD2C DF70                    STX      SAVE6
  267 FD2E CE0070                  LDX      #SAVE6
  268 FD31 BDFE65                  JSR      DIVIDE
  269 FD34 36                      PSHA
  270 FD35 DE6C                    LDX      SAVE4
  271 FD37 9669                    LDAA     SAVE2+1
  272 FD39 8B30                    ADDA     #'0
  273 FD3B A700                    STAA     0,X
  274 FD3D 08                      INX
  275 FD3E DF6C                    STX      SAVE4
  276 FD40 DE6E                    LDX      SAVE5
  277 FD42 32                      PULA
  278 FD43 08                      INX
  279 FD44 08                      INX
  280 FD45 6D01                    TST      1,X
  281 FD47 26DF                    BNE      CVD1
  282                   *
  283 FD49 CE0081                  LDX      #DECB_1
  284 FD4C 6305                    COM      5,X         ZERO SUPPRESS
  285 FD4E 08           ZRSUP      INX
  286 FD4F E600                    LDAB     0,X
  287 FD51 C130                    CMPB     #'0
  288 FD53 27F9                    BEQ      ZRSUP
  289 FD55 730086                  COM      LASTD
  290                   *
  291 FD58 4F           PNTMSG     CLRA                 ZERO FOR DELIM
  292 FD59 9787         STRTMS     STAA     DELIM       STORE DELIMTER
  293                   *
  294 FD5B E600         OUTMSG     LDAB     0,X         GENERAL PURPOSE PRINT
  295 FD5D 08                      INX
  296 FD5E D187                    CMPB     DELIM
  297 FD60 2705                    BEQ      CTLC
  298 FD62 BDFF81                  JSR      OUTCH
  299 FD65 20F4                    BRA      OUTMSG
  300                   *
  301 FD67 BDFF24       CTLC       JSR      POLCAT      POL FOR CHARACTER
  302 FD6A 245B                    BCC      RTS2
  303 FD6C 8D04                    BSR      INCH2
  304 FD6E C11B                    CMPB     #BREAK      BREAK KEY?
  305 FD70 27AA                    BEQ      RSTRT
  306                   *
  307 FD72 7EFF00       INCH2      JMP      INCH
  308                   *
  309 FD75 8DE2         STRING     BSR      STRTMS      PRINT STRING LITERAL
  310 FD77 A600                    LDAA     0,X
  311 FD79 813B                    CMPA     #';
  312 FD7B 275D                    BEQ      OUTD
  313 FD7D 7EFEF2                  JMP      CRLF
  314                   *
  315 FD80 8D46         EVAL       BSR      GETVAL      EVALUATE EXPRESSION
  316                   *
  317 FD82 36           NXTRM      PSHA
  318 FD83 A600                    LDAA     0,X         END OF LINE?
  319 FD85 2702                    BEQ      OUTN
  320 FD87 8129                    CMPA     #')
  321 FD89 32           OUTN       PULA
  322 FD8A 274E                    BEQ      OUTD
  323 FD8C 8D04                    BSR      TERM
  324 FD8E DE64                    LDX      SAVE0
  325 FD90 20F0                    BRA      NXTRM
  326                   *
  327 FD92 36           TERM       PSHA                 GET VALUE
  328 FD93 37                      PSHB
  329 FD94 A600                    LDAA     0,X
  330 FD96 36                      PSHA
  331 FD97 08                      INX
  332 FD98 8D2E                    BSR      GETVAL
  333 FD9A 976A                    STAA     SAVE3
  334 FD9C D76B                    STAB     SAVE3+1
  335 FD9E DF64                    STX      SAVE0
  336 FDA0 CE006A                  LDX      #SAVE3
  337 FDA3 32                      PULA
  338 FDA4 33                      PULB
  339                   *
  340 FDA5 812A                    CMPA     #'*         SEE IF *
  341 FDA7 266E                    BNE      EVAL2
  342 FDA9 32                      PULA                 MULTIPLY
  343 FDAA 9768         MULTIP     STAA     SAVE2
  344 FDAC D769                    STAB     SAVE2+1     2'S COMPLEMENT
  345 FDAE C610                    LDAB     #$10
  346 FDB0 D766                    STAB     SAVE1
  347 FDB2 4F                      CLRA
  348 FDB3 5F                      CLRB
  349                   *
  350 FDB4 740068       MULT       LSR      SAVE2
  351 FDB7 760069                  ROR      SAVE2+1
  352 FDBA 2402                    BCC      NOAD
  353 FDBC 8D5E         MULTI      BSR      ADD
  354 FDBE 6801         NOAD       ASL      1,X
  355 FDC0 6900                    ROL      0,X
  356 FDC2 7A0066                  DEC      SAVE1
  357 FDC5 26ED                    BNE      MULT        LOOP TIL DONE
  358 FDC7 39           RTS2       RTS
  359                   *
  360 FDC8 BDFEA5       GETVAL     JSR      CVBIN       GET VALUE
  361 FDCB 240E                    BCC      OUTV
  362 FDCD C13F                    CMPB     #'?         OF LITERAL
  363 FDCF 260B                    BNE      VAR
  364 FDD1 DF76                    STX      SAVE9       OR INPUT
  365 FDD3 BDFED6                  JSR      INLN
  366 FDD6 8DA8                    BSR      EVAL
  367 FDD8 DE76                    LDX      SAVE9
  368 FDDA 08           OUTD       INX
  369 FDDB 39           OUTV       RTS
  370                   *
  371 FDDC C124         VAR        CMPB     #'$         OR STRING
  372 FDDE 2605                    BNE      VAR1
  373 FDE0 8D90                    BSR      INCH2
  374 FDE2 4F                      CLRA
  375 FDE3 08                      INX
  376 FDE4 39                      RTS
  377                   *
  378 FDE5 C128         VAR1       CMPB     #'(
  379 FDE7 2603                    BNE      VAR2
  380 FDE9 08                      INX
  381 FDEA 2094                    BRA      EVAL
  382                   *
  383 FDEC 8D11         VAR2       BSR      CONVP       OR VARIABLE
  384 FDEE A600                    LDAA     0,X         OR ARRAY ELEMENT
  385 FDF0 E601                    LDAB     1,X
  386 FDF2 DE70                    LDX      SAVE6       LOAD OLD INDEX
  387 FDF4 39                      RTS
  388                   *
  389 FDF5 8D89         ARRAY      BSR      EVAL        LOCATE ARRAY ELEMENT
  390 FDF7 58                      ASLB
  391 FDF8 49                      ROLA
  392 FDF9 DB51                    ADDB     AMPR+1
  393 FDFB 9950                    ADCA     AMPR
  394 FDFD 200E                    BRA      PACK
  395                   *
  396 FDFF E600         CONVP      LDAB     0,X         GET LOCATION
  397 FE01 08                      INX
  398 FE02 37                      PSHB
  399 FE03 C13A                    CMPB     #':
  400 FE05 27EE                    BEQ      ARRAY       OF VARIABLE OR
  401 FE07 4F                      CLRA                 ARRAY ELEMENT
  402 FE08 C43F                    ANDB     #$3F
  403 FE0A CB02                    ADDB     #$02
  404 FE0C 58                      ASLB
  405                   *
  406 FE0D DF70         PACK       STX      SAVE6       STORE OLD INDEX
  407 FE0F 976C                    STAA     SAVE4
  408 FE11 D76D                    STAB     SAVE4+1
  409 FE13 DE6C                    LDX      SAVE4       LOAD NEW INDEX
  410 FE15 33                      PULB
  411 FE16 39                      RTS
  412                   *
  413 FE17 812B         EVAL2      CMPA     #'+         ADDITION
  414 FE19 2606                    BNE      EVAL3
  415 FE1B 32                      PULA
  416 FE1C EB01         ADD        ADDB     1,X
  417 FE1E A900                    ADCA     0,X
  418 FE20 39                      RTS
  419                   *
  420 FE21 812D         EVAL3      CMPA     #'-         SUBTRACTION
  421 FE23 2606                    BNE      EVAL4
  422 FE25 32                      PULA
  423 FE26 E001         SUBTR      SUBB     1,X
  424 FE28 A200                    SBCA     0,X
  425 FE2A 39                      RTS
  426                   *
  427 FE2B 812F         EVAL4      CMPA     #'/         SEE IF IT'S DIVIDE
  428 FE2D 260C                    BNE      EVAL5
  429 FE2F 32                      PULA
  430 FE30 8D33                    BSR      DIVIDE
  431 FE32 974E                    STAA     REMN
  432 FE34 D74F                    STAB     REMN+1
  433 FE36 9668                    LDAA     SAVE2
  434 FE38 D669                    LDAB     SAVE2+1
  435 FE3A 39                      RTS
  436                   *
  437 FE3B 803D         EVAL5      SUBA     #'=         SEE IF EQUAL TEST
  438 FE3D 260C                    BNE      EVAL6
  439 FE3F 32                      PULA
  440 FE40 8DE4                    BSR      SUBTR
  441 FE42 2603                    BNE      NOTEQ
  442 FE44 5D                      TSTB
  443 FE45 2702                    BEQ      EQL
  444 FE47 C6FF         NOTEQ      LDAB     #$FF
  445 FE49 200D         EQL        BRA      COMBOUT
  446                   *
  447 FE4B 4A           EVAL6      DECA                 SEE IF LESS THAN TEST
  448 FE4C 32                      PULA
  449 FE4D 2707                    BEQ      EVAL7
  450                   *
  451 FE4F 8DD5         SUB2       BSR      SUBTR
  452 FE51 59                      ROLB
  453 FE52 4F           COMOUT     CLRA
  454 FE53 C401                    ANDB     #$01
  455 FE55 39                      RTS
  456                   *
  457 FE56 8DF7         EVAL7      BSR      SUB2        GT TEST
  458 FE58 53           COMBOUT    COMB
  459 FE59 20F7                    BRA      COMOUT
  460                   *
  461 FE5B 27           PWRS10     FCB      $27         10000
  462 FE5C 10                      FCB      $10
  463 FE5D 03                      FCB      $03         1000
  464 FE5E E8                      FCB      $E8
  465 FE5F 00                      FCB      $00         100
  466 FE60 64                      FCB      $64
  467 FE61 00                      FCB      $00         10
  468 FE62 0A                      FCB      $0A
  469 FE63 00                      FCB      $00         1
  470 FE64 01                      FCB      $01
  471                   *
  472 FE65 7F0066       DIVIDE     CLR      SAVE1       DEVIDE 16-BITS
  473 FE68 7C0066       GOT        INC      SAVE1
  474 FE6B 6801                    ASL      1,X
  475 FE6D 6900                    ROL      0,X
  476 FE6F 24F7                    BCC      GOT
  477 FE71 6600                    ROR      0,X
  478 FE73 6601                    ROR      1,X
  479 FE75 7F0068                  CLR      SAVE2
  480 FE78 7F0069                  CLR      SAVE2+1
  481 FE7B 8DA9         DIV2       BSR      SUBTR
  482 FE7D 2404                    BCC      OK
  483 FE7F 8D9B                    BSR      ADD
  484 FE81 0C                      CLC
  485 FE82 9C                      FCB      $9C         WHAT?
  486 FE83 0D           OK         SEC
  487 FE84 790069                  ROL      SAVE2+1
  488 FE87 790068                  ROL      SAVE2
  489 FE8A 7A0066                  DEC      SAVE1
  490 FE8D 2712                    BEQ      DONE
  491 FE8F 6400                    LSR      0,X
  492 FE91 6601                    ROR      1,X
  493 FE93 20E6                    BRA      DIV2
  494                   *
  495 FE95 E600         TSTN       LDAB     0,X         TEST FOR NUMERIC
  496 FE97 C13A                    CMPB     #$3A
  497 FE99 2A04                    BPL      NOTDEC
  498 FE9B C130                    CMPB     #'0
  499 FE9D 2C02                    BGE      DONE
  500 FE9F 0D           NOTDEC     SEC
  501 FEA0 39                      RTS
  502 FEA1 0C           DONE       CLC
  503 FEA2 39           DUN        RTS
  504                   *
  505 FEA3 8D31         CVTLN      BSR      INLN
  506                   *
  507 FEA5 8DEE         CVBIN      BSR      TSTN        CONVERT TO BINARY
  508 FEA7 25F9                    BCS      DUN
  509 FEA9 4F           CONT       CLRA
  510 FEAA 5F                      CLRB
  511 FEAB EB00         CBLOOP     ADDB     0,X
  512 FEAD 8900                    ADCA     #$00
  513 FEAF C030                    SUBB     #'0
  514 FEB1 8200                    SBCA     #$00
  515 FEB3 9766                    STAA     SAVE1
  516 FEB5 D767                    STAB     SAVE1+1
  517 FEB7 08                      INX
  518 FEB8 37                      PSHB
  519 FEB9 8DDA                    BSR      TSTN
  520 FEBB 33                      PULB
  521 FEBC 25E3                    BCS      DONE
  522 FEBE 58                      ASLB
  523 FEBF 49                      ROLA
  524 FEC0 58                      ASLB
  525 FEC1 49                      ROLA
  526 FEC2 DB67                    ADDB     SAVE1+1
  527 FEC4 9966                    ADCA     SAVE1
  528 FEC6 58                      ASLB
  529 FEC7 49                      ROLA
  530 FEC8 20E1                    BRA      CBLOOP
  531                   *
  532 FECA C140         INLN6      CMPB     #'@         CANCEL
  533 FECC 2706                    BEQ      NEWLIN
  534 FECE 08                      INX                  '.'
  535 FECF 8C004A                  CPX      #74         LINE LENGTH +2
  536 FED2 2608                    BNE      INLN2
  537 FED4 8D1C         NEWLIN     BSR      CRLF
  538                   *
  539 FED6 CE0002       INLN       LDX      #2          INPUT LINE FROM TERMINA
  540 FED9 09           INLN5      DEX
  541 FEDA 27F8                    BEQ      NEWLIN
  542 FEDC BDFF00       INLN2      JSR      INCH        INPUT CHARACTER
  543 FEDF E787                    STAB     $87,X       STORE IT
  544 FEE1 C15F                    CMPB     #$5F        BACKSPACE?
  545 FEE3 27F4                    BEQ      INLN5
  546                   *
  547 FEE5 C10D         INLIN3     CMPB     #$0D        CARRIAGE RETURN
  548 FEE7 2BF3                    BMI      INLN2
  549 FEE9 26DF                    BNE      INLN6
  550                   *
  551 FEEB 6F87         INLIN4     CLR      $87,X       CLEAR LAST CHAR
  552 FEED CE0088                  LDX      #LINBUF
  553 FEF0 2004                    BRA      LF
  554                   *
  555 FEF2 C60D         CRLF       LDAB     #$0D        CARR-RET
  556 FEF4 8D02                    BSR      OUTCH2
  557 FEF6 C60A         LF         LDAB     #$0A        LINE FEED
  558 FEF8 7EFF81       OUTCH2     JMP      OUTCH
  559                   *
  560 FEFB 0D           OKM        FCB      $0D
  561 FEFC 0A                      FCB      $0A
  562 FEFD 4F4B                    FCC      'OK'
  563 FEFF 00                      FCB      $00
  564                   *
  565 FF00                         END
